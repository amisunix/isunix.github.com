<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Steven's Blog]]></title>
  <link href="http://isunix.github.io/atom.xml" rel="self"/>
  <link href="http://isunix.github.io/"/>
  <updated>2019-06-04T08:47:13+08:00</updated>
  <id>http://isunix.github.io/</id>
  <author>
    <name><![CDATA[Steven Sun]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Git上传大文件]]></title>
    <link href="http://isunix.github.io/blog/2019/06/03/gitshang-chuan-da-wen-jian/"/>
    <updated>2019-06-03T09:28:32+08:00</updated>
    <id>http://isunix.github.io/blog/2019/06/03/gitshang-chuan-da-wen-jian</id>
    <content type="html"><![CDATA[<p>我们如果需要上传大文件到git，比如数据集，可以使用Git Large File Storage <a href="https://git-lfs.github.com">https://git-lfs.github.com</a>.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Pipenv使用备忘]]></title>
    <link href="http://isunix.github.io/blog/2019/05/31/pipenvshi-yong-bei-wang/"/>
    <updated>2019-05-31T08:22:14+08:00</updated>
    <id>http://isunix.github.io/blog/2019/05/31/pipenvshi-yong-bei-wang</id>
    <content type="html"><![CDATA[<p>我在某个python环境下有很多包，我们使用如下的命令把这些包给输出到requirements.txt里去</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">pip freeze &gt; requirements.txt
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>然后我们使用pipenv来创建一个虚拟环境</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">mkdir xxx <span class="o">&amp;&amp;</span> mv requirements.txt xxx <span class="o">&amp;&amp;</span> <span class="nb">cd </span>xxx
</span><span class="line">pipenv --python 3.6
</span><span class="line">pipenv shell
</span><span class="line">pipenv install --dev
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>如果我们想删除创建的virtualenv, 可以</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">pipenv --rm
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>也可以到<code>~/.local/share/virtualenvs</code>下面去手动删除.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[使用豆瓣源安装python包]]></title>
    <link href="http://isunix.github.io/blog/2019/05/31/shi-yong-dou-ban-yuan-an-zhuang-pythonbao/"/>
    <updated>2019-05-31T08:01:15+08:00</updated>
    <id>http://isunix.github.io/blog/2019/05/31/shi-yong-dou-ban-yuan-an-zhuang-pythonbao</id>
    <content type="html"><![CDATA[<p>我们在使用pip安装python的包的时候，可以使用豆瓣源来提高下载速度</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">pip  install  requests -i  https://pypi.doubanio.com/simple/  --trusted-host pypi.doubanio.com
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>在linux和mac上，我们可以在$HOME/.pip/pip.conf里面，写入如下的内容, 那样就不用每次都像上面那样写那么长的一大串了</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="o">[</span>global<span class="o">]</span>
</span><span class="line">index-url <span class="o">=</span> https://pypi.doubanio.com/simple
</span><span class="line"><span class="o">[</span>install<span class="o">]</span>
</span><span class="line">trusted-host <span class="o">=</span> pypi.doubanio.com
</span></code></pre></td></tr></table></div></figure></notextile></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Hadoop权威指南ncdc数据准备工作备忘]]></title>
    <link href="http://isunix.github.io/blog/2019/05/30/hadoopquan-wei-zhi-nan-ncdcshu-ju-zhun-bei-gong-zuo-bei-wang/"/>
    <updated>2019-05-30T09:23:39+08:00</updated>
    <id>http://isunix.github.io/blog/2019/05/30/hadoopquan-wei-zhi-nan-ncdcshu-ju-zhun-bei-gong-zuo-bei-wang</id>
    <content type="html"><![CDATA[<p>&lt;Hadoop: The Definitive Guide, Fourth Edition&gt; <a href="http://hadoopbook.com">http://hadoopbook.com</a> 是本好书, 书中的例子用到了ncdc的数据<a href="ftp://ftp.ncdc.noaa.gov/pub/data/gsod/">ftp://ftp.ncdc.noaa.gov/pub/data/gsod/</a>，这个也是非常赞的。我们知道统计学大师Fisher当年就是在气象工作站，研究气象数据很多年，后来在统计学上面做出了卓越的成就。气象数据纷繁复杂，通过实际的气象数据来阅读这本书，会教会读者在真实的情况下，如何面对数据，这个要比用一些dummy数据做演示，效果好太多.</p>

<p>官网github上面的数据很少<a href="https://github.com/tomwhite/hadoop-book/tree/master/input/ncdc/all">https://github.com/tomwhite/hadoop-book/tree/master/input/ncdc/all</a>. 我们自己从上面的ncdc的链接中去下载，我们下载tar文件. 具体也可以参考这篇文章<a href="https://blog.csdn.net/mrcharles/article/details/50442367">https://blog.csdn.net/mrcharles/article/details/50442367</a></p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="c">#!/bin/bash</span>
</span><span class="line">
</span><span class="line"><span class="c">#这里cd到你想下载到的目录, 每个文件的格式如下所示gsod_1901.tar, 发现tar文件竟然只有从1930年才不是空文件</span>
</span><span class="line"><span class="nv">cdir</span><span class="o">=</span><span class="s2">&quot;$(cd `dirname $0`; pwd)&quot;</span>
</span><span class="line">
</span><span class="line"><span class="k">for </span>i in <span class="k">$(</span>seq 1930 1960<span class="k">)</span>
</span><span class="line"><span class="k">do</span>
</span><span class="line"><span class="k">    </span>wget --execute <span class="nv">robots</span><span class="o">=</span>off —accept<span class="o">=</span>tar -r -np -nH --cut-dirs<span class="o">=</span>4 - R index.html* ftp://ftp.ncdc.noaa.gov/pub/data/gsod/<span class="nv">$i</span>/
</span><span class="line"><span class="k">done</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>下载好了之后，我们把这些1930/gsod_1930.tar 之类的文件，重新命令为1930/1930.tar, 然后把所有的文件都放到一个本地的目录，起名叫gsod， 现在gsod目录里都是1930/1930.tar这样的文件了.</p>

<p>接下来我们在hdfs上创建目录，</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">hdfs dfs -mkdir /GSOD /GSOD_ALL
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>然后将本地的gsod文件夹里的文件都上传到/GSOD/里面去</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">hdfs dfs -put gsod/* /GSOD/
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>这个过程在我的本机上，先是出现了namenode找不到的问题，然后又出现了namenode in safemode，创建不了的问题, 解决办法是</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">stop-all.sh
</span><span class="line">hdfs namenode -format
</span><span class="line">start-all.sh
</span><span class="line">hadoop dfsadmin -safemode leave
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>然后重新执行</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">hdfs dfs -put gsod/* /GSOD/
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>接下来我们要做的就是在hadoop上处理这些数据了. 首先创建generate_input_list.sh来生成MR的input文件:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="c">#!/bin/bash</span>
</span><span class="line">
</span><span class="line"><span class="nv">a</span><span class="o">=</span><span class="nv">$1</span>
</span><span class="line">rm -rf ncdc_files.txt
</span><span class="line">hdfs dfs -rm /ncdc_files.txt
</span><span class="line">
</span><span class="line"><span class="k">while</span> <span class="o">[</span> <span class="nv">$a</span> -le <span class="nv">$2</span> <span class="o">]</span>
</span><span class="line"><span class="k">do</span>
</span><span class="line"><span class="k">        </span><span class="nv">filename</span><span class="o">=</span><span class="s2">&quot;/GSOD/${a}/${a}.tar&quot;</span>
</span><span class="line">        <span class="nb">echo</span> <span class="s2">&quot;$filename&quot;</span> &gt;&gt; ncdc_files.txt
</span><span class="line">        <span class="nv">a</span><span class="o">=</span><span class="sb">`</span>expr <span class="nv">$a</span> + 1<span class="sb">`</span>
</span><span class="line"><span class="k">done</span>
</span><span class="line">
</span><span class="line">hdfs dfs -put ncdc_files.txt /
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>ncdc_files.txt中的每一行就是<code>/GSOD/1950/1950.tar</code>这样的数据.</p>

<p>然后我们来产生文件:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">sh generate_input_list.sh 1901 1956
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>接下来我们来创建load_ncdc_map.sh脚本，在MapReduce的Streaming上正常运行</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="c">#!/bin/bash</span>
</span><span class="line">
</span><span class="line"><span class="nb">read </span>offset hdfs_file
</span><span class="line"><span class="nb">echo</span> -e <span class="s2">&quot;$offset\t$hdfs_file&quot;</span>
</span><span class="line">
</span><span class="line"><span class="c"># Retrieve file from HDFS to local disk</span>
</span><span class="line"><span class="nb">echo</span> <span class="s2">&quot;reporter:status:Retrieving $hdfs_file&quot;</span> &gt;&amp;2
</span><span class="line">/Users/sun1/repo/hadoop-3.1.2/bin/hdfs dfs -get <span class="nv">$hdfs_file</span> .
</span><span class="line"><span class="c"># Create local directory</span>
</span><span class="line"><span class="nv">target</span><span class="o">=</span><span class="sb">`</span>basename <span class="nv">$hdfs_file</span> .tar<span class="sb">`</span>
</span><span class="line">mkdir <span class="nv">$target</span>
</span><span class="line">
</span><span class="line"><span class="nb">echo</span> <span class="s2">&quot;reporter:status:Un-tarring $hdfs_file to $target&quot;</span> &gt;&amp;2
</span><span class="line">tar xf <span class="sb">`</span>basename <span class="nv">$hdfs_file</span><span class="sb">`</span> -C <span class="nv">$target</span>
</span><span class="line"><span class="c"># Unzip each station file and concat into one file</span>
</span><span class="line"><span class="nb">echo</span> <span class="s2">&quot;reporter:status:Un-gzipping $target&quot;</span> &gt;&amp;2
</span><span class="line"><span class="k">for </span>file in <span class="nv">$target</span>/*
</span><span class="line"><span class="k">do</span>
</span><span class="line"><span class="k">        </span>gunzip -c <span class="nv">$file</span> &gt;&gt; <span class="nv">$target</span>.all
</span><span class="line">        <span class="nb">echo</span> <span class="s2">&quot;reporter:status:Processed $file&quot;</span> &gt;&amp;2
</span><span class="line"><span class="k">done</span>
</span><span class="line"><span class="c"># Put gzipped version into HDFS</span>
</span><span class="line"><span class="nb">echo</span> <span class="s2">&quot;reporter:status:Gzipping $target and putting in HDFS&quot;</span> &gt;&amp;2
</span><span class="line">gzip -c <span class="nv">$target</span>.all | /Users/sun1/repo/hadoop-3.1.2/bin/hdfs  dfs -put - /GSOD_ALL/<span class="nv">$target</span>.gz
</span><span class="line">rm <span class="sb">`</span>basename <span class="nv">$hdfs_file</span><span class="sb">`</span>
</span><span class="line">rm -r <span class="nv">$target</span>
</span><span class="line">rm <span class="nv">$target</span>.all
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>然后我们可以使用如下的方式来调用这个shell脚本了:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="c">#!/bin/bash</span>
</span><span class="line">
</span><span class="line">hadoop jar <span class="k">${</span><span class="nv">HADOOP_HOME</span><span class="k">}</span>/share/hadoop/tools/lib/hadoop-streaming-3.1.2.jar <span class="se">\</span>
</span><span class="line">    -D mapreduce.job.reduces<span class="o">=</span>0 <span class="se">\</span>
</span><span class="line">    -D mapreduce.map.speculative<span class="o">=</span><span class="nb">false</span> <span class="se">\</span>
</span><span class="line">    -D mapreduce.task.timeout<span class="o">=</span>12000000 <span class="se">\</span>
</span><span class="line">    -inputformat org.apache.hadoop.mapred.lib.NLineInputFormat <span class="se">\</span>
</span><span class="line">    -input /ncdc_files.txt <span class="se">\</span>
</span><span class="line">    -output /output/gsod <span class="se">\</span>
</span><span class="line">    -mapper load_ncdc_map.sh <span class="se">\</span>
</span><span class="line">    -file load_ncdc_map.sh
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>最后运行完了，我们可以check下目标文件是否生成</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">hdfs dfs -ls /GSOD_ALL
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>以及检查输出的结果</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">hdfs dfs -cat /output/gsod/part-00053
</span></code></pre></td></tr></table></div></figure></notextile></div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[搭建Superset数据报表平台]]></title>
    <link href="http://isunix.github.io/blog/2019/05/23/da-jian-supersetshu-ju-bao-biao-ping-tai/"/>
    <updated>2019-05-23T17:04:08+08:00</updated>
    <id>http://isunix.github.io/blog/2019/05/23/da-jian-supersetshu-ju-bao-biao-ping-tai</id>
    <content type="html"><![CDATA[<p>主要参考链接<a href="https://superset.incubator.apache.org/installation.html">https://superset.incubator.apache.org/installation.html</a></p>

<ol>
  <li>如果想看superset的版本</li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">superset version -v
</span></code></pre></td></tr></table></div></figure></notextile></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[怎样无需手动输入密码连接PostgreSQL]]></title>
    <link href="http://isunix.github.io/blog/2019/05/23/zen-yang-wu-xu-shou-dong-shu-ru-mi-ma-lian-jie-postgresql/"/>
    <updated>2019-05-23T08:44:13+08:00</updated>
    <id>http://isunix.github.io/blog/2019/05/23/zen-yang-wu-xu-shou-dong-shu-ru-mi-ma-lian-jie-postgresql</id>
    <content type="html"><![CDATA[<p>我们要想不每次手动输入密码来连接PostgreSQL, 可以在home目录创建一个pgpass文件<code>touch ~/.pgpass</code>.
然后在里面输入如下的信息<code>$host:$port:$db:$user:$password</code>.
这里的每个变量实际过程中替换成真实的值.
然后我们就可以使用如下的方式来进行psql的连接了<code>psql -h $host -p $port -U $user -d $db</code>.
同理，这里的每个变量实际过程中替换成真实的值.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[使用rpm安装crontab命令备忘]]></title>
    <link href="http://isunix.github.io/blog/2019/05/22/shi-yong-rpman-zhuang-crontabming-ling-bei-wang/"/>
    <updated>2019-05-22T16:36:21+08:00</updated>
    <id>http://isunix.github.io/blog/2019/05/22/shi-yong-rpman-zhuang-crontabming-ling-bei-wang</id>
    <content type="html"><![CDATA[<p>我这边有台ec2, 但是在yum update的时候，总是报错说依赖冲突，后来处理这个问题的时候，过于激进，导致yum不可以用了, 最后把rpm也删了</p>

<p>参考这篇文章
<a href="https://blog.seosiwei.com/detail/27">https://blog.seosiwei.com/detail/27</a>
里的方法2，把rpm和yum都删了然后重装了, 软件下载链接是
<a href="http://mirrors.ustc.edu.cn/centos/6/os/x86_64/Packages/">http://mirrors.ustc.edu.cn/centos/6/os/x86_64/Packages/</a></p>

<p>安装好了之后，发现yum还是不能用，总是报错</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">liblzma.so.0: cannot open shared object file: No such file or directory</span></code></pre></td></tr></table></div></figure></notextile></div>
<p>之类的信息</p>

<p>无可奈何，只好使用rpm了, 我这边需要使用crontab，于是从上面的软件库中下载了</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">cronie-1.4.4-16.el6_8.2.x86_64.rpm``` 和 ```crontabs-1.10-33.el6.noarch.rpm</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>然后执行如下的命令来安装</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">rpm -Uvh --replacepkgs --nodeps --force cron*.rpm</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>然后报各种依赖找不到的错误, 比如</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">librpmio.so.3 not found</span></code></pre></td></tr></table></div></figure></notextile></div>
<p>之类的</p>

<p>好在我们有别的ec2，我们可以去这个另外的ec2上找对应的依赖，然后copy到这个我们出问题的机器上</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">find / -name librpm.so.3 -type f</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>然后发现在/usr/lib64中，librpm.so.3是个软连接，指向/usr/lib64中的librpm.so.3.2.2, 我们把librpm.so.3.2.2copy到我们出问题的机器的/usr/lib64里，然后参照
<a href="http://isunix.github.io/blog/2019/05/22/linuxming-ling-lnde-shi-yong-bei-wang/">http://isunix.github.io/blog/2019/05/22/linuxming-ling-lnde-shi-yong-bei-wang/</a>
中的方式来做个软连接</p>

<p>仿照这个方式，如果还有问题，重复找依赖-copy-做软连接的过程</p>

<p>最后再执行</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">rpm -Uvh --replacepkgs --nodeps --force cron*.rpm</span></code></pre></td></tr></table></div></figure></notextile></div>
<p>crontab命令成功安装了.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Linux命令ln的使用备忘]]></title>
    <link href="http://isunix.github.io/blog/2019/05/22/linuxming-ling-lnde-shi-yong-bei-wang/"/>
    <updated>2019-05-22T16:22:49+08:00</updated>
    <id>http://isunix.github.io/blog/2019/05/22/linuxming-ling-lnde-shi-yong-bei-wang</id>
    <content type="html"><![CDATA[<p>我们现在在/usr/lib64中有个文件librpm.so.3.2.2, 我们想要在/usr/lib64做个软连接, 起名叫做librpm.so.3, 指向librpm.so.3.2.2, 我们可以这样做,</p>

<p><code>cd /usr/lib64 &amp;&amp; ln -s librpm.so.3.2.2 librpm.so.3</code></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Flask中使用ipython的shell]]></title>
    <link href="http://isunix.github.io/blog/2019/05/21/flaskzhong-shi-yong-ipythonde-shell/"/>
    <updated>2019-05-21T19:44:25+08:00</updated>
    <id>http://isunix.github.io/blog/2019/05/21/flaskzhong-shi-yong-ipythonde-shell</id>
    <content type="html"><![CDATA[<p>我们在Flask中使用shell的时候没有语法高亮和代码提示，想要获得一个ipython般的体验，现在有</p>

<ul>
  <li>https://github.com/ei-grad/flask-shell-ipython</li>
</ul>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">pip install flask-shell-ipython</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>装好了之后，执行如下的命令就可以了</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">flask shell</span></code></pre></td></tr></table></div></figure></notextile></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Hive中删除partition]]></title>
    <link href="http://isunix.github.io/blog/2019/05/07/hivezhong-shan-chu-partition/"/>
    <updated>2019-05-07T17:25:48+08:00</updated>
    <id>http://isunix.github.io/blog/2019/05/07/hivezhong-shan-chu-partition</id>
    <content type="html"><![CDATA[<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">alter table xxx drop PARTITION (partition_name&lt;='2019-01-13');</span></code></pre></td></tr></table></div></figure></notextile></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[在ammonite中import第三方jar包]]></title>
    <link href="http://isunix.github.io/blog/2019/05/07/zai-ammonitezhong-importdi-san-fang-jarbao/"/>
    <updated>2019-05-07T16:54:15+08:00</updated>
    <id>http://isunix.github.io/blog/2019/05/07/zai-ammonitezhong-importdi-san-fang-jarbao</id>
    <content type="html"><![CDATA[<h3 id="scalarepl-jar-">我们在scala的repl中, 如果想要引入一个第三方的jar包, 可以使用如下的方式</h3>
<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">:require joda-time-2.1.jar</span></code></pre></td></tr></table></div></figure></notextile></div>

<h3 id="ammonite-">而在ammonite中, 可以使用如下的方式</h3>
<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">import $cp.`joda-time-2.1.jar`</span></code></pre></td></tr></table></div></figure></notextile></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Hive Insert Using Select *]]></title>
    <link href="http://isunix.github.io/blog/2016/08/09/hive-insert-using-select-star/"/>
    <updated>2016-08-09T09:34:49+08:00</updated>
    <id>http://isunix.github.io/blog/2016/08/09/hive-insert-using-select-star</id>
    <content type="html"><![CDATA[<p>I want to insert into a table with values from another table. and I want to use the follwing statements,</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sql"><span class="line"><span class="k">insert</span> <span class="k">into</span> <span class="k">table</span> <span class="n">table_a</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">table_b</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Both table_a and table_b have the followig 3 fields, “name”, “age”, and the “load_day” field which is used to partition.</p>

<p>If using the above syntax, we will get errors saying table has just 2 fields and table_b has 3.</p>

<p>So one right way to insert the data is:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sql"><span class="line"><span class="k">insert</span> <span class="k">into</span> <span class="k">table</span> <span class="n">table_a</span><span class="p">(</span><span class="n">partition</span><span class="o">=</span><span class="ss">&quot;2016-08-01&quot;</span><span class="p">)</span> <span class="k">select</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span> <span class="k">from</span> <span class="n">table_b</span> <span class="k">where</span> <span class="n">load_day</span> <span class="o">=</span> <span class="ss">&quot;2016-08-01&quot;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>What if there are many fields, thus we will need to list them one by one after select which is very tedious.</p>

<p>Here is the solution,</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="sql"><span class="line"><span class="k">set</span> <span class="n">hive</span><span class="p">.</span><span class="k">exec</span><span class="p">.</span><span class="k">dynamic</span><span class="p">.</span><span class="n">partition</span><span class="p">.</span><span class="k">mode</span><span class="o">=</span><span class="n">nonstrict</span><span class="p">;</span>
</span><span class="line"><span class="k">insert</span> <span class="k">into</span> <span class="k">table</span> <span class="n">table_a</span> <span class="n">partition</span><span class="p">(</span><span class="n">load_day</span><span class="p">)</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">table_b</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Copy and Paste Spaces Separated Text Into Excel]]></title>
    <link href="http://isunix.github.io/blog/2016/08/04/copy-and-paste-spaces-separated-text-into-excel/"/>
    <updated>2016-08-04T16:06:03+08:00</updated>
    <id>http://isunix.github.io/blog/2016/08/04/copy-and-paste-spaces-separated-text-into-excel</id>
    <content type="html"><![CDATA[<p>最近经常需要把空格作为delimiter的文本粘贴到excel里。之前的做法是</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">cat aa.log | awk <span class="s1">&#39;{print $1}&#39;</span> | pbcopy
</span></code></pre></td></tr></table></div></figure></notextile></div>
<p>来一列一列地copy到excel里。甚是繁琐。 excel不会用的啊。</p>

<p>今天发现了原来还可以这么来操作。</p>

<ol>
  <li>把整个文件的内容粘贴到excel里去</li>
  <li>在excel中选中文件内容， 然后点击 Data-&gt;Text to Columns, 然后选择合适的delimiter去把文本内容给搞到excel中去。</li>
</ol>

<p>Bingo！</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Weird Things Happen When Scripts Executing With . And Passing Args With Getopts]]></title>
    <link href="http://isunix.github.io/blog/2016/07/19/weird-things-happen-when-scripts-executing-with-and-passing-args-with-getopts/"/>
    <updated>2016-07-19T17:43:32+08:00</updated>
    <id>http://isunix.github.io/blog/2016/07/19/weird-things-happen-when-scripts-executing-with-and-passing-args-with-getopts</id>
    <content type="html"><![CDATA[<p>I have met the following scripts, say aa.sh</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nb">echo</span> <span class="s2">&quot;OPTIND for aa.sh before calling is: &quot;</span> <span class="nv">$OPTIND</span>
</span><span class="line"><span class="k">while </span><span class="nb">getopts</span> <span class="s2">&quot;t:c:&quot;</span> opt
</span><span class="line"><span class="k">do</span>
</span><span class="line"><span class="k">    case</span> <span class="s2">&quot;$opt&quot;</span> in
</span><span class="line">        t<span class="o">)</span> <span class="nb">time</span><span class="o">=</span><span class="s2">&quot;${OPTARG}&quot;</span>;;
</span><span class="line">        c<span class="o">)</span> <span class="nv">count</span><span class="o">=</span><span class="s2">&quot;${OPTARG}&quot;</span>;;
</span><span class="line">    <span class="k">esac</span>
</span><span class="line"><span class="k">done</span>
</span><span class="line">
</span><span class="line"><span class="nb">echo</span> <span class="s2">&quot;time for aa.sh is $time&quot;</span>
</span><span class="line"><span class="nb">echo</span> <span class="s2">&quot;count for aa.sh is $count&quot;</span>
</span><span class="line"><span class="nb">echo</span> <span class="s2">&quot;OPTIND for aa.sh after calling is: &quot;</span> <span class="nv">$OPTIND</span><span class="sb">`</span>sh
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>and bb.sh</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nb">echo</span> <span class="s2">&quot;OPTIND for bb.sh before calling is: &quot;</span> <span class="nv">$OPTIND</span>
</span><span class="line"><span class="nb">echo</span> <span class="s2">&quot;we are setting the OPTIND to 1&quot;</span>
</span><span class="line"><span class="k">while </span><span class="nb">getopts</span> <span class="s2">&quot;t:c:&quot;</span> opt
</span><span class="line"><span class="k">do</span>
</span><span class="line"><span class="k">    case</span> <span class="s2">&quot;$opt&quot;</span> in
</span><span class="line">        t<span class="o">)</span> <span class="nb">time</span><span class="o">=</span><span class="s2">&quot;${OPTARG}&quot;</span>;;
</span><span class="line">        c<span class="o">)</span> <span class="nv">count</span><span class="o">=</span><span class="s2">&quot;${OPTARG}&quot;</span>;;
</span><span class="line">    <span class="k">esac</span>
</span><span class="line"><span class="k">done</span>
</span><span class="line">
</span><span class="line"><span class="nb">echo</span> <span class="s2">&quot;time for bb.sh is $time&quot;</span>
</span><span class="line"><span class="nb">echo</span> <span class="s2">&quot;count for bb.sh is $count&quot;</span>
</span><span class="line">
</span><span class="line"><span class="nb">echo</span> <span class="s2">&quot;OPTIND for bb.sh after calling is: &quot;</span> <span class="nv">$OPTIND</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>and call.sh</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">. ./aa.sh -t 2016-07-15 -c 4
</span><span class="line">. ./bb.sh -a 2016-07-20 -c 0
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>and now execute the script, it will give out the followig result,</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">OPTIND <span class="k">for </span>aa.sh before calling is:  1
</span><span class="line"><span class="nb">time </span><span class="k">for </span>aa.sh is 2016-07-15
</span><span class="line">count <span class="k">for </span>aa.sh is 4
</span><span class="line">OPTIND <span class="k">for </span>aa.sh after calling is:  5
</span><span class="line">OPTIND <span class="k">for </span>bb.sh before calling is:  <span class="nv">5</span>
</span><span class="line"><span class="o">=</span><span class="nb">time </span><span class="k">for </span>bb.sh is 2016-07-15
</span><span class="line">count <span class="k">for </span>bb.sh is 4
</span><span class="line">OPTIND <span class="k">for </span>bb.sh after calling is:  5
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Which is definitely not what we want.</p>

<p>We can now change bb.sh into the following to test it again.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nb">echo</span> <span class="s2">&quot;OPTIND for bb.sh before calling is: &quot;</span> <span class="nv">$OPTIND</span>
</span><span class="line">
</span><span class="line"><span class="nv">OPTIND</span><span class="o">=</span>1
</span><span class="line">
</span><span class="line"><span class="nb">echo</span> <span class="s2">&quot;we are setting the OPTIND to 1&quot;</span>
</span><span class="line"><span class="k">while </span><span class="nb">getopts</span> <span class="s2">&quot;t:c:&quot;</span> opt
</span><span class="line"><span class="k">do</span>
</span><span class="line"><span class="k">    case</span> <span class="s2">&quot;$opt&quot;</span> in
</span><span class="line">        t<span class="o">)</span> <span class="nb">time</span><span class="o">=</span><span class="s2">&quot;${OPTARG}&quot;</span>;;
</span><span class="line">        c<span class="o">)</span> <span class="nv">count</span><span class="o">=</span><span class="s2">&quot;${OPTARG}&quot;</span>;;
</span><span class="line">    <span class="k">esac</span>
</span><span class="line"><span class="k">done</span>
</span><span class="line">
</span><span class="line"><span class="nb">echo</span> <span class="s2">&quot;time for bb.sh is $time&quot;</span>
</span><span class="line"><span class="nb">echo</span> <span class="s2">&quot;count for bb.sh is $count&quot;</span>
</span><span class="line">
</span><span class="line"><span class="nb">echo</span> <span class="s2">&quot;OPTIND for bb.sh after calling is: &quot;</span> <span class="nv">$OPTIND</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>and now “sh call.sh” will give out the following result,</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">OPTIND <span class="k">for </span>aa.sh before calling is:  1
</span><span class="line"><span class="nb">time </span><span class="k">for </span>aa.sh is 2016-07-15
</span><span class="line">count <span class="k">for </span>aa.sh is 4
</span><span class="line">OPTIND <span class="k">for </span>aa.sh after calling is:  5
</span><span class="line">OPTIND <span class="k">for </span>bb.sh before calling is:  5
</span><span class="line">we are setting the OPTIND to 1
</span><span class="line"><span class="nb">time </span><span class="k">for </span>bb.sh is 2016-07-20
</span><span class="line">count <span class="k">for </span>bb.sh is 0
</span><span class="line">OPTIND <span class="k">for </span>bb.sh after calling is:  5
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>What if we set the OPTIND to 3 now?</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">OPTIND <span class="k">for </span>aa.sh before calling is:  1
</span><span class="line"><span class="nb">time </span><span class="k">for </span>aa.sh is 2016-07-15
</span><span class="line">count <span class="k">for </span>aa.sh is 4
</span><span class="line">OPTIND <span class="k">for </span>aa.sh after calling is:  5
</span><span class="line">OPTIND <span class="k">for </span>bb.sh before calling is:  5
</span><span class="line">we are setting the OPTIND to 3
</span><span class="line"><span class="nb">time </span><span class="k">for </span>bb.sh is 2016-07-15
</span><span class="line">count <span class="k">for </span>bb.sh is 0
</span><span class="line">OPTIND <span class="k">for </span>bb.sh after calling is:  5
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Now the count value is changed to 0, however time is still not changed.</p>

<p>How to understand this? First let us look at the definitions of $OPTIND and getopts</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">A <span class="nb">getopts </span>construct usually comes packaged in a <span class="k">while </span>loop, which processes the options and
</span><span class="line">arguments one at a <span class="nb">time</span>, <span class="k">then </span>increments the implicit <span class="nv">$OPTIND</span> variable to point to the next.
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>In a while loop contaning getopts, getopts will use $OPTIND to find the arguments. if we call the script using “dot” which is the same as using “source”, $OPTIND will be global and available to the next script using getopts, and the next script will then can not find the right argument using $OPTIND now. </p>

<p>The solution here is, we can reset $OPTIND to 1 or we can call the script using “sh” rather than “.”</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[怎么去除windows编辑过的文件中的^M字符]]></title>
    <link href="http://isunix.github.io/blog/2016/07/18/zen-yao-qu-chu-windowsbian-ji-guo-de-wen-jian-zhong-de-mzi-fu/"/>
    <updated>2016-07-18T08:12:34+08:00</updated>
    <id>http://isunix.github.io/blog/2016/07/18/zen-yao-qu-chu-windowsbian-ji-guo-de-wen-jian-zhong-de-mzi-fu</id>
    <content type="html"><![CDATA[<p>We can use the following two methods to get rid of the “^M” character in a file which was edited on windows using vim.</p>

<p>1.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">:%s/<span class="se">\r</span>//g
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>2.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line">:%s/ctrl-v ctrl-m//g
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>The second one means pressing ctrl-v, then ctrl-m first.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Regexp_extract Usage in Impala]]></title>
    <link href="http://isunix.github.io/blog/2016/07/15/regexp-extract-usage-in-impala/"/>
    <updated>2016-07-15T10:43:30+08:00</updated>
    <id>http://isunix.github.io/blog/2016/07/15/regexp-extract-usage-in-impala</id>
    <content type="html"><![CDATA[<p>I need to use the regexp_extract function to extract certain parts of a string recently when I am doing big data analysis.</p>

<p>http://www.cloudera.com/documentation/archive/impala/2-x/2-1-x/topics/impala_string_functions.html, this link shows us how to do, but sadly regex in impala is a little different from those in perl or python, so I have to look through the page and try again.</p>

<p>I keep a note here for regexp_extract for my later own usage.</p>

<p>Say I have a string </p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">%2C%22hidisp%22%3A27%2C%22quietMode</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>and I want to extract the number followd by “hidisp” and ‘”:’, which is number ‘27’ here.</p>

<p>As describe in the above document, </p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">Because the impala-shell interpreter uses the \ character for escaping, use \\ to represent the regular expression escape character in any regular expressions that you submit through impala-shell</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>So if we want to represent the numbers here, we have use ‘\d’ rather than just ‘\d’ which is a standard in other programming  languages.</p>

<p>regexp_extract usage is in the following format,</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">regexp_extract(string subject, string pattern, int index)</span></code></pre></td></tr></table></div></figure></notextile></div>

<ol>
  <li>group 0 matches the full pattern string, including the portion outside any () group, so</li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">select regexp_extract('%2C%22hidisp%22%3A27%2C%22quietMode', 'hidisp%22%3A(\\d+)', 0);</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>this will give out:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">hidisp%22%3A27</span></code></pre></td></tr></table></div></figure></notextile></div>

<ol>
  <li>group 1 matches just the contents inside the first () group in the pattern string:</li>
</ol>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">select regexp_extract('%2C%22hidisp%22%3A27%2C%22quietMode', 'hidisp%22%3A(\\d+)', 1);</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>will give out</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">27</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>And for the support of non-greedy matches using .*?, take the following string as an example,</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">%2C%22reboot%22%3A27%2C%22quietMode%2C%22reboot%22%3A12%2C%22quietMode</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>How to extract the first match number for “reboot”, we can get the result in the following ways</p>

<p>a. without any “.*?” around the string pattern ‘reboot%22%3A(\d+)’, which is the easiest way I think </p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">select regexp_extract('%2C%22reboot%22%3A27%2C%22quietMode%2C%22reboot%22%3A12%2C%22quietMode', 'reboot%22%3A(\\d+)', 1);</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>or </p>

<p>b. append “.*?” right after the string pattern ‘reboot%22%3A(\d+)’,</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">select regexp_extract('%2C%22reboot%22%3A27%2C%22quietMode%2C%22reboot%22%3A12%2C%22quietMode', 'reboot%22%3A(\\d+).*?', 1);</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>or</p>

<p>c. surround the string pattern ‘reboot%22%3A(\d+)’ with ‘.*?’ at both sides</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">select regexp_extract('%2C%22reboot%22%3A27%2C%22quietMode%2C%22reboot%22%3A12%2C%22quietMode', '.*?reboot%22%3A(\\d+).*?', 1);</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>So after the tree ways to get the leftmost match, we can easily guess how to get the rifht-most match.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class=""><span class="line">select regexp_extract('%2C%22reboot%22%3A27%2C%22quietMode%2C%22reboot%22%3A12%2C%22quietMode', '.*?reboot%22%3A(\\d+)', 1);</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>That is just by appending the string pattern with ‘.*?’ at its left side.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Tmux: Error While Loading Shared Libraries: libevent-2.0.so.5]]></title>
    <link href="http://isunix.github.io/blog/2016/07/12/tmux-error-while-loading-shared-libraries-libevent-2-dot-0-so-dot-5/"/>
    <updated>2016-07-12T10:34:50+08:00</updated>
    <id>http://isunix.github.io/blog/2016/07/12/tmux-error-while-loading-shared-libraries-libevent-2-dot-0-so-dot-5</id>
    <content type="html"><![CDATA[<p>I have kept a blog on tmux installation which is about missing module libevent, and the post is on:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="html"><span class="line">http://isunix.github.io/blog/2014/12/24/libevent-not-found-error-while-install-tmux/
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Recently even after I install the livevent module, I still get the following errors after installing tmux and then running tmux:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="html"><span class="line"> ./tmux: error while loading shared libraries: libevent-2.0.so.5: cannot open shared object file: No such file or
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>I installed the libevent lib in $HOME/local/lib, and tmux says it can not find the library, Weird. With the help of one of my colleague, this problem is solved.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nb">export </span><span class="nv">DIR</span><span class="o">=</span><span class="s2">&quot;$HOME/local&quot;</span>
</span><span class="line"><span class="nb">export </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="nv">$LD_LIBRARY_PATH</span>:<span class="nv">$DIR</span>/lib
</span><span class="line">./configure --prefix<span class="o">=</span><span class="nv">$DIR</span> <span class="nv">CFLAGS</span><span class="o">=</span><span class="s2">&quot;-I$DIR/include&quot;</span> <span class="nv">LDFLAGS</span><span class="o">=</span><span class="s2">&quot;-L$DIR/lib&quot;</span>
</span><span class="line">make
</span><span class="line">make install
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>As we can see, the point here is setting the “LD_LIBRARY_PATH” variable.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Configure Hive on Mac]]></title>
    <link href="http://isunix.github.io/blog/2016/07/02/configure-hive-on-mac/"/>
    <updated>2016-07-02T18:14:13+08:00</updated>
    <id>http://isunix.github.io/blog/2016/07/02/configure-hive-on-mac</id>
    <content type="html"><![CDATA[<p>花了很长的时间在hive的安装和配置上， 先把有用的链接记下来， 等有空了再详细的写下安装过程。</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
</pre></td><td class="code"><pre><code class="html"><span class="line">http://stackoverflow.com/questions/5016505/mysql-grant-all-privileges-on-database
</span><span class="line">https://cwiki.apache.org/confluence/display/Hive/AdminManual+Configuration
</span><span class="line">http://stackoverflow.com/questions/27099898/java-net-urisyntaxexception-when-starting-hive
</span><span class="line">https://noobergeek.wordpress.com/2013/11/09/simplest-way-to-install-and-configure-hive-for-mac-osx-lion/
</span><span class="line">https://cwiki.apache.org/confluence/display/Hive/GettingStarted
</span><span class="line">https://amodernstory.com/2015/03/29/installing-hive-on-mac/
</span></code></pre></td></tr></table></div></figure></notextile></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Update All Python Modules Through Pip]]></title>
    <link href="http://isunix.github.io/blog/2016/03/31/update-all-python-modules-through-pip/"/>
    <updated>2016-03-31T16:32:49+08:00</updated>
    <id>http://isunix.github.io/blog/2016/03/31/update-all-python-modules-through-pip</id>
    <content type="html"><![CDATA[<p>I want to update all the installed python modules through pip. Here below is one recipe I found.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
</pre></td><td class="code"><pre><code class="py"><span class="line"><span class="kn">import</span> <span class="nn">pip</span>
</span><span class="line"><span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">call</span>
</span><span class="line">
</span><span class="line"><span class="k">for</span> <span class="n">dist</span> <span class="ow">in</span> <span class="n">pip</span><span class="o">.</span><span class="n">get_installed_distributions</span><span class="p">():</span>
</span><span class="line">    <span class="n">call</span><span class="p">(</span><span class="s">&quot;pip install --upgrade &quot;</span> <span class="o">+</span> <span class="n">dist</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Sort an Object by One Key Using Js]]></title>
    <link href="http://isunix.github.io/blog/2016/03/09/sort-an-object-by-one-key-using-js/"/>
    <updated>2016-03-09T09:41:03+08:00</updated>
    <id>http://isunix.github.io/blog/2016/03/09/sort-an-object-by-one-key-using-js</id>
    <content type="html"><![CDATA[<p>I have something like the following,</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">var</span> <span class="nx">sophos</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;aa&quot;</span><span class="p">,</span> <span class="nx">time</span><span class="o">:</span><span class="s2">&quot;2016/03/02 01:12&quot;</span><span class="p">};</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">mcafee</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;bb&quot;</span><span class="p">,</span> <span class="nx">time</span><span class="o">:</span><span class="s2">&quot;2016/03/03 01:12&quot;</span><span class="p">};</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">trend</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;cc&quot;</span><span class="p">,</span> <span class="nx">time</span><span class="o">:</span><span class="s2">&quot;2016/03/04 01:12&quot;</span><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>and I want to find out the one with the earliest time, in the above code, it is “2016/03/02 01:12”, and the corresponding item is “sophos”, here is the realization is js code.</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
</pre></td><td class="code"><pre><code class="js"><span class="line"><span class="kd">var</span> <span class="nx">sophos</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;aa&quot;</span><span class="p">,</span> <span class="nx">time</span><span class="o">:</span><span class="s2">&quot;2016/03/02 01:12&quot;</span><span class="p">};</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">mcafee</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;bb&quot;</span><span class="p">,</span> <span class="nx">time</span><span class="o">:</span><span class="s2">&quot;2016/03/03 01:12&quot;</span><span class="p">};</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">trend</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;cc&quot;</span><span class="p">,</span> <span class="nx">time</span><span class="o">:</span><span class="s2">&quot;2016/03/04 01:12&quot;</span><span class="p">};</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">[</span><span class="nx">sophos</span><span class="p">,</span> <span class="nx">mcafee</span><span class="p">,</span> <span class="nx">trend</span><span class="p">];</span>
</span><span class="line">
</span><span class="line"><span class="kd">function</span> <span class="nx">compare</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">){</span>
</span><span class="line">    <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">time</span> <span class="o">&lt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">time</span><span class="p">){</span>
</span><span class="line">        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">.</span><span class="nx">time</span> <span class="o">&gt;</span> <span class="nx">b</span><span class="p">.</span><span class="nx">time</span><span class="p">){</span>
</span><span class="line">        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">    <span class="k">else</span> <span class="p">{</span>
</span><span class="line">        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="nx">compare</span><span class="p">);</span>
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
]]></content>
  </entry>
  
</feed>
